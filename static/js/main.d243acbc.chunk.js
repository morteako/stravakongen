(this.webpackJsonpstravakongen=this.webpackJsonpstravakongen||[]).push([[0],{116:function(e,t,n){e.exports=n.p+"static/media/Elianto-Regular.217c0af5.ttf"},117:function(e,t,n){"use strict";n.r(t);var a,r=n(0),o=n.n(r),c=n(26),s=n.n(c),i=(n(71),n(4)),u=n(33),l=n.n(u),m=n(6),d="https://www.strava.com/api/v3/",g=function(e,t){return l.a.request(t,{params:{access_token:e}})},f=function(e,t,n){return"club"!==t&&"skip"!==n?"".concat(e,"&").concat(t,"=").concat(n):e},b=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return d+t.join("/")+"?"},p=function(e,t){return f(function(e,t){return f(b("segments",t,"leaderboard"),"club_id",e)}(e,t),"per_page",50)},k={all:p,year:function(e,t){return f(p(e,t),"date_range","this_year")},month:function(e,t){return f(p(e,t),"date_range","this_month")}},v=function(e){var t=Object(r.useState)(null),n=Object(i.a)(t,2),a=n[0],o=n[1],c=Object(r.useState)(null),s=Object(i.a)(c,2),u=s[0],l=s[1],d=e.club,f=e.segmentId,p=Object(m.e)((function(e){return e.accessToken}));return Object(r.useEffect)((function(){if(p){var t=(0,k[e.dateRange])(d.id||d,f);g(p,t).then((function(t){l({id:f,dateRange:e.dateRange,leaderboard:t.data.entries})}))}}),[f,e.dateRange,d,p]),Object(m.d)((function(e){return e.addLeaderboard}))(u),Object(r.useEffect)((function(){if(p){var e=b("segments",f);g(p,e).then((function(e){o(e.data)}))}}),[f,p]),Object(m.d)((function(e){return e.addSegment}))(a),null},y=n(58),_=n(23),h=n(24),O=n.n(h),j=function(e){var t=e.map((function(e,t){return Object(_.a)({},e,{rankPos:t})})),n=Object.values(Object(h.groupBy)(t,(function(e){return e.score})));return n.flatMap((function(e){return e.map((t=e[0].rankPos,function(e){return Object(_.a)({},e,{rankPos:t})}));var t}))},E=function(e){return 51-e},w=function(e,t,n,a,r,o){var c=t.filter((function(e){return n[e]})),s=Object.entries(e).map((function(e){var t=Object(i.a)(e,2),n=t[0],o=t[1];return{athleteName:n,ranks:c.map((function(e){return t=o[e],n=e,t?{score:r(t.rank),effort:!0,start_date:t.start_date}:{score:a(n)};var t,n}))}})).filter((function(e){return e.ranks.some((function(e){return e.effort}))})).map((function(e){var t=e.athleteName,n=e.ranks;return{athleteName:t,ranks:n,score:n.reduce((function(e,t){return e+t.score}),0)}})),u=Object.entries(s).map((function(e){return Object(i.a)(e,2)[1]}));return u.sort(o),j(u)},S=n(3),N=n.n(S),C=function(e){var t=parseInt(e,10),n=new Date(null);return n.setSeconds(t),n.getHours()>1?n.toISOString().substr(11,8):n.toISOString().substr(14,5)},I=function(e){var t=e.elapsed_time,n=e.start_date_local,a=e.rank,r=e.segmentData,c=e.clicked,s=function(e){return e.substr(0,10).split("-").reverse().join(".")}(n),i=C(t),u=E(a),l=c?u+"p":"#"+a,m=o.a.createElement("div",null,o.a.createElement("b",null,i)," ","- ".concat(l)),d=function(e,t){if(!t||!t.distance)return"";if("Ride"===t.activity_type)return(t.distance/(1e3*e/3600)).toFixed(1)+" km/t";if("Run"===t.activity_type){var n=1e3*e/t.distance;return C(n)+" min/km"}return""}(t,r),g={1:N.a.entry_first,2:N.a.entry_second,3:N.a.entry_third}[a]||N.a.entry_normal,f=function(e){var t=Math.abs(new Date-new Date(e));return Math.ceil(t/864e5)<7}(n)?" ".concat(N.a.entry_border):"";return o.a.createElement("td",{className:g+f},m," ",o.a.createElement("span",null,c&&s+" - "+d))},R=function(e){return o.a.createElement("td",null," ")},x=function(e){var t=Object(i.a)(e.args,5),n=t[0],a=t[1],r=t[2],c=t[3],s=t[4],u=e.clicked,l=e.flipClicked,d=Object(m.e)((function(e){return e}));return o.a.createElement("tr",{onClick:l},o.a.createElement("td",null,o.a.createElement("b",null,n),{0:" \ud83e\udd47",1:" \ud83e\udd48",2:" \ud83e\udd49"}[s]),o.a.createElement("td",{className:N.a.ranktext_header},o.a.createElement("span",{className:N.a.ranktext_rank},s+1),o.a.createElement("span",{className:N.a.ranktext_score}," (".concat(a,")"))),Array.from(c).map((function(e,t){return function(e,t,n,a){var r=Object(_.a)({},e,{segmentData:t,clicked:n});return e?o.a.createElement(I,Object.assign({key:a},r)):o.a.createElement(R,{key:a})}(r[e],d.segments[e],u,t)})))},G=function(e){var t=e.segmentId,n=e.realSegmentName,a=e.providedSegmentName,r=e.numAthletes,c=e.distance,s=e.averageGrade,i=e.clicked,u=Math.round(c/1e3*10)/10,l=s,m=" - ".concat(u+"km"," ").concat(l,"% (").concat(r,")"),d=i?n:a||n;return o.a.createElement("a",{className:N.a.header,href:"https://www.strava.com/segments/"+t,onClick:function(e){return e.stopPropagation()}},d," ",i&&m)},M=function(e){var t=e.child;return o.a.createElement("th",{className:N.a.header},t)},T=function(e){var t=e.segmentRowMapper,n=Object(m.e)((function(e){return e})).segmentRowClicked,a=o.a.useState(n),r=Object(i.a)(a,2),c=r[0],s=r[1];return Object(m.d)((function(e){return e.setSegmentRowClicked}))(c),o.a.createElement("tr",{onClick:function(){return s(!c)}},o.a.createElement(M,{child:"Navn"}),o.a.createElement(M,{child:"# (Poeng)"}),t(c).map((function(e){return o.a.createElement(M,{key:e.props.segmentId,child:e})})))},A=n(17),L={1942901:{name:"Tryvann",groups:{"klatrekongen-vest":1,klatrekongen:1,allroundern:1,tryvanndobbelen:1}},4252879:{name:"Olaf Bulls vei",groups:{"klatrekongen-vest":1}},660072:{name:"Grefsenkollen",groups:{"klatrekongen-vest":1,"Klatrekongen-ost":1,klatrekongen:1,allroundern:1}},632847:{name:"Kongsveien",groups:{klatrekongen:1,"klatrekongen-ost":1}},666298:{name:"Svartskogbakken",groups:{"klatrekongen-ost":1}},2783427:{name:"Sognsvann rundt motsols",groups:{lopekongen:1,allroundern:1,bliss:1}},2462560:{name:"Sognsvann rundt medsols",groups:{bliss:1}},2553283:{name:"Tour de Finance l\xf8p",groups:{lopekongen:1,bml:1}},657002:{groups:{bml:1}},21317574:{groups:{bml:1}},1032853:{groups:{bml:1}},11861324:{groups:{bml:1}},5891167:{name:"Sognsvann - Ullev\xe5lseter",groups:{bliss:1}},1557103:{name:"Vettakollen opp",groups:{lopekongen:1,allroundern:1,bliss:1}},5102820:{name:"Holmenkollveien",groups:{tryvanndobbelen:1}},9358707:{name:"Hammeren-Kikutkrysset",groups:{"kikut-sykkel":1}},1331159:{name:"Zinoberveien - Kikut",groups:{"kikut-sykkel":1}},8059590:{name:"Grefsenkollen ned",groups:{utforkongen:1}},14733934:{name:"Tryvann ned",groups:{utforkongen:1}},6890951:{name:"Greveveien downhill",groups:{utforkongen:1}},666794:{name:"S\xf8rkedalen",groups:{tempokongen:1}},1229519:{name:"Maridalen",groups:{tempokongen:1}},23325175:{groups:{"nurc-trondheim":1}},23330779:{groups:{"nurc-trondheim":1}},23330813:{groups:{"nurc-trondheim":1}},23330843:{groups:{"nurc-trondheim":1}},23330762:{groups:{"nurc-trondheim":1}}};Object.keys(L).forEach((function(e){return L[e].id=e}));var P="cycling",D="running",K="downhill",B="climbing",H="bliss",U=(a={},Object(A.a)(a,P,"\ud83d\udeb4\ud83c\udffc\u200d\u2642\ufe0f"),Object(A.a)(a,D,"\ud83c\udfc3\ud83c\udffb\u200d\u2642\ufe0f"),Object(A.a)(a,K," \u2b07\ufe0f \ud83d\ude35"),Object(A.a)(a,B," \ud83d\uddfb"),Object(A.a)(a,H,""),a),V=function(e){return q[e]&&q[e].types.map((function(e){return U[e]})).join(" ")},q={klatrekongen:{navn:"Klatrekongen",types:[P,B]},bml:{navn:"Breaking Marathon Limits",types:[D]},lopekongen:{navn:"L\xf8pekongen",types:[D]},"klatrekongen-vest":{navn:"Klatrekongen Vest",types:[P,B]},"klatrekongen-ost":{navn:"Klatrekongen \xd8st",types:[P,B]},tempokongen:{navn:"Tempokongen",types:[P]},utforkongen:{navn:"Utforkongen",types:[P,K]},tryvanndobbelen:{navn:"Tryvanndobbel",types:[P,D,B]},allroundern:{navn:"Allrounder'n",types:[P,D]},bliss:{navn:"Bliss",types:[D,H]},"nurc-trondheim":{navn:"NURC Trondheim",types:[D]}},F=function(e,t,n){if(e.name)return"Navn";if(e.score)return"Poeng";if(e.segmentId){var a=t&&t[e.segmentId]&&t[e.segmentId].name,r=L&&L[e.segmentId]&&L[e.segmentId].name;return n&&a||r||a||e.segmentId}return e.newest?"Nyeste oppf\xf8ring":void 0},J=function(e){var t=e.sortingMode,n=e.segments,a=e.dateRange,r=e.clicked,c=e.setClicked,s=Object(m.e)((function(e){return e})),u=s.segments,l=s.athleteEfforts[a],d=s.segmentLeaderboards[a],g=function(e,t,n){return w(e,t,n,(function(e){return 0}),E,(function(e,t){return t.score-e.score}))}(l,n,d).sort(function(e,t,n){return e.name?function(e,t){return e.athleteName.localeCompare(t.athleteName)}:e.score?function(e,t){return e.rankPos-t.rankPos}:e.segmentId?function(t,a){return(n[t.athleteName][e.segmentId]&&n[t.athleteName][e.segmentId].elapsed_time||1/0)-(n[a.athleteName][e.segmentId]&&n[a.athleteName][e.segmentId].elapsed_time||1/0)}:e.newest?function(e,a){var r=Object.entries(n[e.athleteName]).filter((function(e){var n=Object(i.a)(e,1)[0];return t.includes(parseInt(n))})).map((function(e){var t=Object(i.a)(e,2)[1];return new Date(t.start_date)})),o=Object.entries(n[a.athleteName]).filter((function(e){var n=Object(i.a)(e,1)[0];return t.includes(parseInt(n))})).map((function(e){var t=Object(i.a)(e,2)[1];return new Date(t.start_date)}));return O.a.max(o)-O.a.max(r)}:void 0}(t,n,l)).map((function(e,t){var a=e.athleteName,s=e.score,i=e.rankPos;return o.a.createElement(x,{key:a,args:[a,s,l[a],n,i],clicked:r,flipClicked:function(){return c(!r)}})}));return o.a.createElement(y.a,{striped:!0,bordered:!0,hover:!0},o.a.createElement("thead",null,o.a.createElement(T,{segmentRowMapper:function(e){return n.map((function(t){var n=d[t]?d[t].length:"",a=L[t]&&L[t].name,r=u[t]&&u[t].name;return o.a.createElement(G,{key:t,segmentId:t,numAthletes:n,realSegmentName:r,providedSegmentName:a,distance:u[t]&&u[t].distance,averageGrade:u[t]&&u[t].average_grade,clicked:e})}))}})),o.a.createElement("tbody",null,g))},W=n(60),Z=n(39),Q=n(36),z=n(20),$=n(11),X=n(13),Y=n.n(X),ee=n(18),te={all:"Gjennom alle tider",year:"I \xe5r",month:"Denne m\xe5neden"},ne=function(e){var t=e.props,n=t.segmentGroup,a=t.dateRange,r=t.sortMode,c=t.currentSegments,s=t.setDateRange,u=t.setSortMode,l=t.setSegmentGroup,d=t.club,g=Object(m.e)((function(e){return e})).segmentRowClicked,f=Object.entries(te).map((function(e){var t=Object(i.a)(e,2),n=t[0],a=t[1];return o.a.createElement($.a.Item,{key:n,className:N.a.dropdown_item,onClick:function(e){var t;Object(X.writeStorage)("period",n),t=n,ee.a.event({category:"Period",action:"Changed period",label:t}),s(n)}},a)})),b=[{score:!0},{name:!0},{newest:!0}].concat(c.map((function(e){return{segmentId:e}}))),p=Object(m.e)((function(e){return e.segments})),k=b.map((function(e){var t=F(e,p,g);return o.a.createElement($.a.Item,{key:t,className:N.a.dropdown_item,onClick:function(){!function(e){ee.a.event({category:"Sorting",action:"Changed sorting",label:e})}(t),u(e)}},t)})),v=Object(Q.a)(k),y=v[0],_=v[1],h=(v[2],v.slice(3)),O=o.a.createElement($.a,{key:"divider",className:N.a.divider}),j=[y,_,O].concat(Object(Z.a)(h)),E=function(e){return e?Object.keys(q).filter((function(t){return q[t].types.every((function(t){return!e.types||e.types.includes(t)}))})):q}(d);return o.a.createElement("div",{className:N.a.button_row},o.a.createElement(z.a,{className:N.a.button,title:"Segmentgruppe : "+q[n].navn+" "+V(n)},function(e){var t=Object(Q.a)(e),n=t[0],a=t[1],r=t.slice(2);return[n,a,O].concat(Object(Z.a)(r))}(E.map((function(e){return o.a.createElement($.a.Item,{key:e,className:N.a.dropdown_item,onClick:function(){!function(e){ee.a.event({category:"Segment group",action:"Changed group",label:e})}(e),l(e)}},q[e].navn+V(e))})))),o.a.createElement(z.a,{className:N.a.button,title:"Periode : "+te[a]},f),o.a.createElement(z.a,{className:N.a.button,title:"Sortering : "+F(r,p,g)},j))},ae=function(e){return re[e]?re[e]:e||re.bekk},re={all:{id:"skip",name:"Ingen valgt klubb",types:[D,P,K,B]},bekk:{id:8433,name:"Bekk",types:[D,P,K,B]},bml:{id:551609,name:"Breaking Marathon Limits",types:[D,K]}},oe=function(e){var t=Object.values(re).map((function(e){return o.a.createElement($.a.Item,{key:e.id,className:N.a.dropdown_item,onClick:function(){!function(e){ee.a.event({category:"Club",action:"Changed club",label:e.name})}(e),Object(X.writeStorage)("club",e),window.location.reload(!0)}},e.name)})),n=e.club&&e.club.name||e.club;return o.a.createElement("div",{className:N.a.button_row},o.a.createElement(z.a,{className:N.a.button,title:"Klubb : "+n},t))},ce=function(e){var t=e.segmentGroup,n=q[t]?t:"bml",a=o.a.useState(e.period||"year"),c=Object(i.a)(a,2),s=c[0],u=c[1],g=o.a.useState(n),f=Object(i.a)(g,2),b=f[0],p=f[1];Object(r.useEffect)((function(){return Object(X.writeStorage)("segmentGroup",b)}),[b]);var k=o.a.useState({score:!0}),y=Object(i.a)(k,2),_=y[0],h=y[1],O=o.a.useState(!1),j=Object(i.a)(O,2),E=j[0],w=j[1],S=W.parse(e.location.search);!function(){var e=o.a.useState(null),t=Object(i.a)(e,2),n=t[0],a=t[1];o.a.useEffect((function(){l.a.post(d+"oauth/token",{client_id:"39382",grant_type:"refresh_token",client_secret:"be12733c5800f88bba8a353c0089cb6ccaa7bbbd",refresh_token:"8e7c1f0a3911e6c54150ebc3cbdbde9066270ee4"}).then((function(e){a(e.data.access_token)})).catch((function(e){return console.log(e)}))}),[]),Object(m.d)((function(e){return e.addAccessToken}))(n)}();var C=[];try{var I=JSON.parse(S.segments);C=I.some(isNaN)?[]:I}catch(A){}var R,x,G=Object.values(L).filter((function(e){return e.groups[b]})).map((function(e){return e.id})),M=C.length>0?C:G,T=(R=S.club,x=e.lsClub,!R&&x?re[x]||x:ae(R));return o.a.createElement("div",null,o.a.createElement("h1",{className:N.a.headerHeadline},"STRAVAKONGEN"),o.a.createElement(oe,{club:T}),o.a.createElement(ne,{props:{currentSegments:M,sortMode:_,segmentGroup:b,dateRange:s,setDateRange:u,setSortMode:h,setSegmentGroup:p,clicked:E,club:T}}),o.a.createElement(J,{sortingMode:_,segments:M,dateRange:s,clicked:E,setClicked:w}),M.map((function(e,t){return o.a.createElement(v,{key:t,club:T,dateRange:s,segmentId:e})})))},se=n(63),ie=n(16),ue=Object(m.c)({accessToken:null,athleteEfforts:{all:{},year:{},month:{}},segmentLeaderboards:{all:{},year:{},month:{}},segments:{},segmentRowClicked:!1,leaderboardClicked:!1,setSegmentRowClicked:Object(m.b)((function(e,t){e.segmentRowClicked=t})),setLeaderboardClicked:Object(m.b)((function(e,t){e.leaderboardClicked=t})),addAccessToken:Object(m.b)((function(e,t){t&&(e.accessToken=t)})),addSegment:Object(m.b)((function(e,t){if(t){var n=t.name,a=t.distance,r=t.average_grade,o=t.activity_type;e.segments[t.id]={name:n,distance:a,average_grade:r,activity_type:o}}})),addLeaderboard:Object(m.b)((function(e,t){if(t){var n=t.leaderboard.filter((function(e){return e.rank<=50})),a=t.id;e.segmentLeaderboards[t.dateRange][a]=n;n.forEach((function(n){n.segment=a;var r=e.athleteEfforts[t.dateRange][n.athlete_name]||{};r[n.segment]=n,e.athleteEfforts[t.dateRange][n.athlete_name]=r}))}}))});ee.a.initialize("UA-163677104-1",{debug:!1,titleCase:!1,gaOptions:{siteSpeedSampleRate:100}}),ee.a.pageview(window.location.pathname+window.location.search);var le=function(){var e=Y()("segmentGroup"),t=Object(i.a)(e,1)[0],n=Y()("club"),a=Object(i.a)(n,1)[0],r=Y()("period"),c=Object(i.a)(r,1)[0];return function(){var e=document.querySelector('meta[name="viewport"]');e&&(e.content="initial-scale=1",e.content="width=device-width")}(),o.a.createElement(m.a,{store:ue},o.a.createElement(se.a,null,o.a.createElement(ie.a,{path:"/",component:function(e){return o.a.createElement(ce,Object.assign({},e,{segmentGroup:t,lsClub:a,period:c}))}})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(116);s.a.render(o.a.createElement(le,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},3:function(e,t,n){e.exports={entry_first:"mystyle_entry_first__GZGLw",entry_second:"mystyle_entry_second__13TpZ",entry_third:"mystyle_entry_third__3fLIV",entry_normal:"mystyle_entry_normal__34dj6",button_row:"mystyle_button_row__17d_B",button:"mystyle_button__1ALQQ",ranktext_td:"mystyle_ranktext_td__1tHWr",ranktext_rank:"mystyle_ranktext_rank__2OPnq",ranktext_score:"mystyle_ranktext_score__1CaNx",header:"mystyle_header__1abc1",th:"mystyle_th__1KFdi",score:"mystyle_score__3Csax",divider:"mystyle_divider__1Tx-L",entry_border:"mystyle_entry_border__1ohS_",headerHeadline:"mystyle_headerHeadline__150AA"}},66:function(e,t,n){e.exports=n(117)},71:function(e,t,n){}},[[66,1,2]]]);
//# sourceMappingURL=main.d243acbc.chunk.js.map